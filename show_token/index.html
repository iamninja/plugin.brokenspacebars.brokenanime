<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>Broken Anime</title>
  <meta name="description" content="Broken Anime">
  <meta name="author" content="SitePoint">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha512-NhSC1YmyruXifcj/KFRWoC561YpHpc5Jtzgvbuzx5VozKpWvQ+4nXhPdFgmx8xqexRcpAglTj9sIBWINXa8x5w==" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/skeleton/2.0.4/skeleton.min.css" integrity="sha512-EZLkOqwILORob+p0BXZc+Vm3RgJBOe1Iq/0fiI7r/wJgzOFZMlsqTa29UEl6v6U6gsV4uIpsNZoV32YZqrCRCQ==" crossorigin="anonymous" />
  <link href="https://fonts.googleapis.com/css?family=Press+Start+2P" rel="stylesheet">
  <link href="https://unpkg.com/nes.css@latest/css/nes.min.css" rel="stylesheet" />

  <style>
    html, body, pre, code, kbd, samp, h1 {
        font-family: "Press Start 2P";
    }
    .copied-balloon {
      display: none;
      position: absolute;
      padding: 1rem;
      box-shadow: 0 5px 20px 5px rgba(0,0,0,.6);
      z-index: 1;
    }
    .center {
        justify-content: center;
        margin: auto;
        text-align: center;
    }
    .height-100 {
        height: 100px;
    }
    .height-10 {
        height: 10px;
    }
    .right {
      float: right;
    }
  </style>

  <script>
    const queryString = window.location.hash;
    const urlParams = new URLSearchParams(queryString);

    const token = urlParams.get('#access_token');
  </script>

</head>

<body>
  <div class="container center is-dark">
      <div class="row">
          <div class="ten columns offset-by-one">
              <h1>Broken Anime</h1>
          </div>
      </div>

      <div class="row height-100"></div>

      <div class="row">
          <div class="eight columns offset-by-two nes-container">
              <p>
                  Copy the token below and paste it on Kodi
                  <div class="height-10"></div>
                  <label for="token_field">Access Token</label>
                  <textarea id="token_field" class="nes-textarea">
                  </textarea>
                  <div id="copied-balloon" class="nes-balloon from-right copied-balloon">
                    <p>copied!!</p>
                  </div>
                  <button type="button" onClick="copyToken(event)" class="nes-btn right">copy</button>
              </p>
          </div>
      </div>
  </div>

  <script>
    copiedBalloon = document.getElementById('copied-balloon');
    const textArea = document.getElementById('token_field');
    textArea.value = token;

    function copyToken(event) {
      textArea.select();
      textArea.setSelectionRange(0,99999);

      document.execCommand("copy");
      console.log(event.pageX, event.pageY, event);
      showCopiedBalloon(textArea.offsetTop, textArea.offsetLeft);
    }

    function showCopiedBalloon(top, left) {
      copiedBalloon = document.getElementById('copied-balloon');

      copiedBalloon.style.display = 'block';
      copiedBalloon.style.top = `${top + 10}px`;
      copiedBalloon.style.left = `${left + 200}px`;

      setTimeout(() => {
        copiedBalloon.style.display = 'none';
      }, 1000);
    }
  </script>
</body>
</html>
